<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watch Together</title>
    <!-- Add FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <!-- Username modal -->
    <div class="username-modal" id="username-modal">
        <div class="modal-content">
            <h2>Enter your name</h2>
            <input type="text" id="username-input" placeholder="Your name..." autocomplete="off">
            <button id="username-submit">Join Chat</button>
        </div>
    </div>
    
    <!-- Admin request modal -->
    <div class="admin-request-modal" id="admin-request-modal">
        <div class="modal-content">
            <h2>Admin Request</h2>
            <p id="admin-request-message"></p>
            <button id="accept-admin-request">Accept</button>
            <button id="reject-admin-request">Reject</button>
        </div>
    </div>

    <!-- Main container for side-by-side layout -->
    <div class="main-container">
        <!-- Chat section (LEFT) -->
        <div class="chat-section">
            <div class="chat-container">
                <ul id="messages"></ul>
            </div>
            
            <!-- Voice status indicators above the form -->
            <div class="users-in-call" id="users-in-call"></div>
            
            <form id="form" action="">
                <!-- Voice chat button now inside the form -->
                <div class="voice-chat-controls">
                    <!-- Just the icon, no text -->
                    <button id="voice-chat-toggle" class="voice-chat-btn">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <div class="voice-status" id="voice-status">Voice chat inactive</div>
                </div>
                
                <input id="input" autocomplete="off" placeholder="Type a message..." />
                <button id="send"><i class="fas fa-paper-plane"></i></button>
            </form>
        </div>
        
        <!-- Video section (RIGHT) -->
        <div class="video-section">
            <div class="admin-notice" id="admin-notice"></div>
            <div class="video-container">
                <!-- Fallback video player for direct video URLs -->
                <video id="direct-video-player" controls style="display: none; width: 100%; height: 100%;">
                    <source src="" type="video/mp4">
                    Your browser does not support HTML5 video.
                </video>
                
                <!-- YouTube and other embedded players -->
                <iframe id="video-player" src="" frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen></iframe>
            </div>
            <div class="video-controls">
                <input type="text" class="video-url-input" id="video-url" 
                    placeholder="Enter any video URL (YouTube, Vimeo, direct MP4, etc.)">
                <button class="change-video-btn" id="change-video">Change Video</button>
            </div>
            <div class="admin-controls" id="admin-controls">
                <p>You are the admin controller. You control the video for everyone.</p>
                <div class="admin-video-controls">
                    <button id="admin-play" class="admin-btn"><i class="fas fa-play"></i> Play for Everyone</button>
                    <button id="admin-pause" class="admin-btn"><i class="fas fa-pause"></i> Pause for Everyone</button>
                    <button id="admin-restart" class="admin-btn"><i class="fas fa-redo"></i> Restart Video</button>
                </div>
            </div>
            <div id="request-admin-container" style="margin-top: 10px; text-align: center; display: none;">
                <button class="request-admin-btn" id="request-admin">Request Admin Control</button>
            </div>
            <div class="admin-viewing-notice" id="admin-viewing-notice">Admin is controlling playback...</div>
        </div>
    </div>
    
    <!-- Include Socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    <!-- Include platform-specific API scripts -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://player.vimeo.com/api/player.js"></script>
    <!-- Link to external JavaScript file -->
    <script src="/js/main.js"></script>
</body>
</html>